version: '3.7'
services:
    mongo:
        image: mongo
        volumes:
            - mongo:/data/db
        env_file:
            - .env

    cache:
        image: redis:7-alpine
        env_file:
            - .env
        command: redis-server --save 20 1 --loglevel warning
        volumes:
            - cache:/data

    recipes:
        build:
            context: .
        env_file:
            - .env
        ports:
            - '3000:3000'
        depends_on:
            - mongo
            - cache
        links:
            - mongo
            - cache
        volumes:
            - ./:/usr/src/app

volumes:
    mongo:
        driver: local
    cache:
        driver: local
